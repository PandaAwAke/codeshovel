{
  "origin": "codeshovel",
  "repositoryName": "commons-io",
  "repositoryPath": "/repos/commons-io/.git",
  "startCommitName": "559de2c461e94ab636c959149c775bb27111fb48",
  "sourceFileName": "FileCleaningTracker.java",
  "functionName": "run",
  "functionId": "run",
  "sourceFilePath": "src/main/java/org/apache/commons/io/FileCleaningTracker.java",
  "functionStartLine": 219,
  "functionEndLine": 234,
  "changeHistory": [
    "6aa00766b9103d75c763160280429af8e1f0549e",
    "ec8a3410e55e7fcc45102451c439cc86383524d3",
    "3f124c68426718bd5870a85930fd075c151ccb33",
    "83f7246c3e9fe1d3f1ad6cf7ea0715a573fe2f2a",
    "8ae4137b10ccab1408b9df36c10c06568c10acd7",
    "431c428c4df6a7197a8703ad50f9dc5d3501130b",
    "9c18390762527fe8d1bf7af8ded586566cdbb59c",
    "e47d347ce4255b8964e384bf0df170281c78d070",
    "daedcb79bcb483f96214be190d7d1f02be8aef86"
  ],
  "changeHistoryShort": {
    "6aa00766b9103d75c763160280429af8e1f0549e": "Ybodychange",
    "ec8a3410e55e7fcc45102451c439cc86383524d3": "Ybodychange",
    "3f124c68426718bd5870a85930fd075c151ccb33": "Ybodychange",
    "83f7246c3e9fe1d3f1ad6cf7ea0715a573fe2f2a": "Yfilerename",
    "8ae4137b10ccab1408b9df36c10c06568c10acd7": "Ybodychange",
    "431c428c4df6a7197a8703ad50f9dc5d3501130b": "Ymovefromfile",
    "9c18390762527fe8d1bf7af8ded586566cdbb59c": "Ybodychange",
    "e47d347ce4255b8964e384bf0df170281c78d070": "Ybodychange",
    "daedcb79bcb483f96214be190d7d1f02be8aef86": "Yintroduced"
  },
  "changeHistoryDetails": {
    "6aa00766b9103d75c763160280429af8e1f0549e": {
      "type": "Ybodychange",
      "commitMessage": "Use final where possible.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/io/trunk@1415850 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1354308699000,
      "commitName": "6aa00766b9103d75c763160280429af8e1f0549e",
      "commitAuthor": "Gary D. Gregory",
      "commitDateOld": 1333120391000,
      "commitNameOld": "3ef56378e33ed5ccc296806e4ad6b8c463e5979f",
      "commitAuthorOld": "Gary D. Gregory",
      "daysBetweenCommits": 245.24,
      "commitsBetweenForRepo": 143,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,16 @@\n         public void run() {\n             // thread exits when exitWhenFinished is true and there are no more tracked objects\n             while (exitWhenFinished \u003d\u003d false || trackers.size() \u003e 0) {\n                 try {\n                     // Wait for a tracker to remove.\n-                    Tracker tracker \u003d (Tracker) q.remove(); // cannot return null\n+                    final Tracker tracker \u003d (Tracker) q.remove(); // cannot return null\n                     trackers.remove(tracker);\n                     if (!tracker.delete()) {\n                         deleteFailures.add(tracker.getPath());\n                     }\n                     tracker.clear();\n-                } catch (InterruptedException e) {\n+                } catch (final InterruptedException e) {\n                     continue;\n                 }\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "ec8a3410e55e7fcc45102451c439cc86383524d3": {
      "type": "Ybodychange",
      "commitMessage": "Fix to resolve OutOfMemoryError has now caused another issue. Try adding a *pause* to see if additional times allows the file delete to complete. If not provide a facility to show that the delete failed.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/io/trunk@1005707 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1286510577000,
      "commitName": "ec8a3410e55e7fcc45102451c439cc86383524d3",
      "commitAuthor": "Niall Pemberton",
      "commitDateOld": 1286468955000,
      "commitNameOld": "3f124c68426718bd5870a85930fd075c151ccb33",
      "commitAuthorOld": "Niall Pemberton",
      "daysBetweenCommits": 0.48,
      "commitsBetweenForRepo": 5,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,16 @@\n         public void run() {\n             // thread exits when exitWhenFinished is true and there are no more tracked objects\n             while (exitWhenFinished \u003d\u003d false || trackers.size() \u003e 0) {\n                 try {\n                     // Wait for a tracker to remove.\n                     Tracker tracker \u003d (Tracker) q.remove(); // cannot return null\n                     trackers.remove(tracker);\n-                    tracker.delete();\n+                    if (!tracker.delete()) {\n+                        deleteFailures.add(tracker.getPath());\n+                    }\n                     tracker.clear();\n                 } catch (InterruptedException e) {\n                     continue;\n                 }\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "3f124c68426718bd5870a85930fd075c151ccb33": {
      "type": "Ybodychange",
      "commitMessage": "IO-161 try to fix OutOfMemoryError being thrown by FileCleaningTrackerTestCase in Gump and fix a potential *hanging* situation.\n\nRemove the tracker from the list first. Theres a potential loop-for-ever situation if for some reason the delete fails because the Tracker will have been removed from the queue but still be in the List - and this method loops until the List is empty.\n\nHopefully this will also resolve the FileCleaningTrackerTestCase\u0027s OutOfMemoryError in Gump and Continuum. Its failing during the file.delete() operation - the test code to fill-up-memory continues until the Tracker List is zero.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/io/trunk@1005515 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1286468955000,
      "commitName": "3f124c68426718bd5870a85930fd075c151ccb33",
      "commitAuthor": "Niall Pemberton",
      "commitDateOld": 1286218476000,
      "commitNameOld": "83f7246c3e9fe1d3f1ad6cf7ea0715a573fe2f2a",
      "commitAuthorOld": "Niall Pemberton",
      "daysBetweenCommits": 2.9,
      "commitsBetweenForRepo": 35,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n         public void run() {\n             // thread exits when exitWhenFinished is true and there are no more tracked objects\n             while (exitWhenFinished \u003d\u003d false || trackers.size() \u003e 0) {\n                 try {\n                     // Wait for a tracker to remove.\n                     Tracker tracker \u003d (Tracker) q.remove(); // cannot return null\n+                    trackers.remove(tracker);\n                     tracker.delete();\n                     tracker.clear();\n-                    trackers.remove(tracker);\n                 } catch (InterruptedException e) {\n                     continue;\n                 }\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "83f7246c3e9fe1d3f1ad6cf7ea0715a573fe2f2a": {
      "type": "Yfilerename",
      "commitMessage": "Build changes - re-organize to standard m2 layout, remove useless JIRA report and fix some Ant issues\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/io/trunk@1004358 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1286218476000,
      "commitName": "83f7246c3e9fe1d3f1ad6cf7ea0715a573fe2f2a",
      "commitAuthor": "Niall Pemberton",
      "commitDateOld": 1286214840000,
      "commitNameOld": "19f48eb1711427a43a5e10c84bbbf1218a08bdd2",
      "commitAuthorOld": "Niall Pemberton",
      "daysBetweenCommits": 0.04,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "extendedDetails": {
        "oldPath": "src/java/org/apache/commons/io/FileCleaningTracker.java",
        "newPath": "src/main/java/org/apache/commons/io/FileCleaningTracker.java"
      }
    },
    "8ae4137b10ccab1408b9df36c10c06568c10acd7": {
      "type": "Ybodychange",
      "commitMessage": "See IO-159: remove() never returns null\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/io/trunk@919676 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1267834107000,
      "commitName": "8ae4137b10ccab1408b9df36c10c06568c10acd7",
      "commitAuthor": "Sebastian Bazley",
      "commitDateOld": 1262998763000,
      "commitNameOld": "3718aace0e233794e765e39b2542251f45ea9452",
      "commitAuthorOld": "Sebastian Bazley",
      "daysBetweenCommits": 55.96,
      "commitsBetweenForRepo": 20,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,14 @@\n         public void run() {\n             // thread exits when exitWhenFinished is true and there are no more tracked objects\n             while (exitWhenFinished \u003d\u003d false || trackers.size() \u003e 0) {\n-                Tracker tracker \u003d null;\n                 try {\n                     // Wait for a tracker to remove.\n-                    tracker \u003d (Tracker) q.remove();\n-                } catch (Exception e) {\n-                    continue;\n-                }\n-                if (tracker !\u003d null) {\n+                    Tracker tracker \u003d (Tracker) q.remove(); // cannot return null\n                     tracker.delete();\n                     tracker.clear();\n                     trackers.remove(tracker);\n+                } catch (InterruptedException e) {\n+                    continue;\n                 }\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "431c428c4df6a7197a8703ad50f9dc5d3501130b": {
      "type": "Ymovefromfile",
      "commitMessage": "Created the FileCleaningTracker, basically a non-static\nversion of the FileCleaner, which can be controlled by\nthe user.\nPR: IO-116\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/io/trunk@518041 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1173855003000,
      "commitName": "431c428c4df6a7197a8703ad50f9dc5d3501130b",
      "commitAuthor": "Jochen Wiedmann",
      "commitDateOld": 1171485505000,
      "commitNameOld": "aa1ba1e649a6b9afa5393b0a1599db0fe1df3a57",
      "commitAuthorOld": "Henri Yandell",
      "daysBetweenCommits": 27.42,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "extendedDetails": {
        "oldPath": "src/java/org/apache/commons/io/FileCleaner.java",
        "newPath": "src/java/org/apache/commons/io/FileCleaningTracker.java",
        "oldMethodName": "run",
        "newMethodName": "run"
      }
    },
    "9c18390762527fe8d1bf7af8ded586566cdbb59c": {
      "type": "Ybodychange",
      "commitMessage": "IO-99 - FileCleaner.exitWhenFinished, to allow the thread to be terminated\nincludes some code from Jochen Wiedmann\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/io/trunk@482437 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1165281185000,
      "commitName": "9c18390762527fe8d1bf7af8ded586566cdbb59c",
      "commitAuthor": "Stephen Colebourne",
      "commitDateOld": 1157067271000,
      "commitNameOld": "dc5bb1187f027d3b9cdc70d3517c442d7b4c45ef",
      "commitAuthorOld": "Stephen Colebourne",
      "daysBetweenCommits": 95.07,
      "commitsBetweenForRepo": 54,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,17 @@\n         public void run() {\n-            for (;;) {\n+            // thread exits when exitWhenFinished is true and there are no more tracked objects\n+            while (exitWhenFinished \u003d\u003d false || trackers.size() \u003e 0) {\n                 Tracker tracker \u003d null;\n                 try {\n                     // Wait for a tracker to remove.\n                     tracker \u003d (Tracker) q.remove();\n                 } catch (Exception e) {\n                     continue;\n                 }\n-\n-                tracker.delete();\n-                tracker.clear();\n-                trackers.remove(tracker);\n+                if (tracker !\u003d null) {\n+                    tracker.delete();\n+                    tracker.clear();\n+                    trackers.remove(tracker);\n+                }\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "e47d347ce4255b8964e384bf0df170281c78d070": {
      "type": "Ybodychange",
      "commitMessage": "Made a start on getting us Checkstyle clean. Fixed a few hundred gripes,\nbut there are still many, many more.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/io/trunk@140614 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1098591607000,
      "commitName": "e47d347ce4255b8964e384bf0df170281c78d070",
      "commitAuthor": "Martin Cooper",
      "commitDateOld": 1079589854000,
      "commitNameOld": "daedcb79bcb483f96214be190d7d1f02be8aef86",
      "commitAuthorOld": "Martin Cooper",
      "daysBetweenCommits": 219.93,
      "commitsBetweenForRepo": 65,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,15 @@\n         public void run() {\n             for (;;) {\n                 Tracker tracker \u003d null;\n                 try {\n                     // Wait for a tracker to remove.\n                     tracker \u003d (Tracker) q.remove();\n-                } catch(Exception _) {\n+                } catch (Exception e) {\n                     continue;\n                 }\n \n                 tracker.delete();\n                 tracker.clear();\n                 trackers.remove(tracker);\n             }\n         }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "daedcb79bcb483f96214be190d7d1f02be8aef86": {
      "type": "Yintroduced",
      "commitMessage": "New file cleaner that keeps track of files pending deletion, and deletes\nthem only when an associated marker object is reclaimed by the garbage\ncollector. This class avoids the need to use File.deleteOnExit() in a\nserver environment.\n\nObtained from: Noel Bergman\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/io/trunk@140546 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": 1079589854000,
      "commitName": "daedcb79bcb483f96214be190d7d1f02be8aef86",
      "commitAuthor": "Martin Cooper"
    }
  }
}